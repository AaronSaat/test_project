<?php

namespace app\controllers;

use Yii;
use yii\web\Controller;
use app\models\Accounts;
use app\models\Journal;
use app\models\Journalumum;
use app\models\Journaldetail;
use app\models\DetailCompare;
use app\models\JournalCompare;
use app\models\AccountCompare;
use yii\data\ActiveDataProvider;
use yii\web\UploadedFile;
use app\models\JsonUploadForm;

class ApiController extends Controller
{ 
    public function beforeAction($action) 
    { 
        $this->enableCsrfValidation = false; 
        return parent::beforeAction($action); 
    }

    public function actionIndex()
    {
        $query = Accounts::find();
        $dataProvider = new ActiveDataProvider([
            'query' => $query,
            'pagination' => [
                'pageSize' => 100, 
            ],
        ]);

        return $this->render('index', [
            'dataProvider' => $dataProvider,
        ]);
    }

    public function actionJournalIndex()
    {

        // // $query = JournalCompare::find();
        // $query = JournalCompare::find()->limit(100); 
        // ganti 51000
        $query = JournalCompare::find()->limit(20000);

        $dataProvider = new ActiveDataProvider([
            'query' => $query,
            'pagination' => [
                'pageSize' => 1000,
                // 'pagination' => false,
            ],
        ]);

        return $this->render('journalindex', [
            'dataProvider' => $dataProvider,
        ]);
    }

    public function actionViewDetailJournalIndex($id)
    {
        $journalCompare = JournalCompare::findOne($id);
        $number = $journalCompare->number;

        $dataProvider = new ActiveDataProvider([
            'query' => DetailCompare::find()->where(['number' => $number]),
            // 'pagination' => [
            //     'pageSize' => 200, 
            // ],
        ]);

        return $this->render('viewdetailjournalindex', [
            'journalCompare' => $journalCompare,
            'dataProvider' => $dataProvider,
        ]);
    }

    public function actionJsonUploadIndex()
    {
        $model = new JsonUploadForm();

        if (Yii::$app->request->isPost) {
            $model->file = UploadedFile::getInstance($model, 'file');

            if ($model->validate()) {
                $uploadPath = Yii::getAlias('@webroot/uploads/');

                // Pastikan direktori tujuan ada, jika tidak buat baru
                if (!is_dir($uploadPath)) {
                    mkdir($uploadPath, 0777, true);
                }

                //hapus semua dulu lalu input ulang
                // AccountCompare::deleteAll();

                // Simpan file di direktori
                $filePath = $uploadPath . $model->file->name;
                if ($model->file->saveAs($filePath)) {
                    // Baca isi file JSON
                    $jsonData = file_get_contents($filePath);
                    $decodedData = json_decode($jsonData, true);
                    
                    if (isset($decodedData['GLACCNT'])) {
                        $filteredData = [];
                        foreach ($decodedData['GLACCNT'] as $item) {
                            if (isset($item['GLACCOUNT']) && isset($item['ACCOUNTNAME'])) {
                                $currencyCode = "";
                                $accountType = "";
                                if (isset($item['CURRENCYID'])) {
                                    $currencyCode = $item['CURRENCYID'] == 1 ? "IDR" : "";
                                }
                                if (isset($item['FIRSTPARENTACCOUNT'])) {
                                    $parentNo = $item['FIRSTPARENTACCOUNT'] ?? "";
                                }
                                if (isset($item['ACCOUNTTYPE'])) {
                                    switch ($item['ACCOUNTTYPE']) {
                                        case 7:
                                            $accountType = "ACCOUNT_PAYABLE";
                                            break;
                                        case 8:
                                            $accountType = "ACCOUNT_RECEIVABLE";
                                            break;
                                        case 9:
                                            $accountType = "ACCUMULATED_DEPRECIATION";
                                            break;
                                        case 10:
                                            $accountType = "CASH_BANK";
                                            break;
                                        case 11:
                                            $accountType = "COGS";
                                            break;
                                        case 12:
                                            $accountType = "EQUITY";
                                            break;
                                        case 13:
                                            $accountType = "EXPENSE";
                                            break;
                                        case 14:
                                            $accountType = "FIXED_ASSET";
                                            break;
                                        case 15:
                                            $accountType = "INVENTORY";
                                            break;
                                        case 16:
                                            $accountType = "LONG_TERM_LIABILITY";
                                            break;
                                        case 17:
                                            $accountType = "OTHER_ASSET";
                                            break;
                                        case 18:
                                            $accountType = "OTHER_CURRENT_ASSET";
                                            break;
                                        case 19:
                                            $accountType = "OTHER_CURRENT_LIABILITY";
                                            break;
                                        case 20:
                                            $accountType = "OTHER_EXPENSE";
                                            break;
                                        case 21:
                                            $accountType = "OTHER_INCOME";
                                            break;
                                        case 22:
                                            $accountType = "REVENUE";
                                            break;
                                        default:
                                            $accountType = "";  // Default 
                                            break;
                                    }
                                }

                                $filteredData[] = [
                                    'no' => $item['GLACCOUNT'],
                                    'asOf' => date('d/m/Y'), 
                                    'accountType' => $accountType,
                                    'currencyCode' => $currencyCode,
                                    'name' => $item['ACCOUNTNAME'],
                                    'memo' => $item['MEMO'],
                                    'parentNo' => $parentNo,
                                ];

                                $AccountCompare = new AccountCompare();
                                $AccountCompare->no = $item['GLACCOUNT'];
                                $AccountCompare->accountType = $accountType;
                                $AccountCompare->name =$item['ACCOUNTNAME'];
                                $AccountCompare->parentNo = $parentNo;
                                $AccountCompare->save();
                            }
                        }
                        
                        Yii::$app->session->set('importAccountFromJson', $filteredData);
                        // Render view untuk menampilkan tabel
                        Yii::$app->session->setFlash('success', "File berhasil diunggah ke: {$filePath}");
                        return $this->render('jsonuploadaccounttable', [
                            'filteredData' => $filteredData,
                        ]);
                    } else {
                        Yii::$app->session->setFlash('error', 'Key "GLACCNT" tidak ditemukan dalam file JSON.');
                    }
                } else {
                    Yii::$app->session->setFlash('error', 'Gagal menyimpan file.');
                }

                return $this->refresh();
            }
        }

        return $this->render('jsonuploadindex', [
            'model' => $model,
        ]);
    }

    //ini untuk proses lama, yang baru menggunakan function sendJournalApi
    public function actionJsonUploadJurnalIndex()
    {
        $model = new JsonUploadForm();

        if (Yii::$app->request->isPost) {
            $model->journalFile = UploadedFile::getInstance($model, 'journalFile');
            $model->journalDetailFile = UploadedFile::getInstance($model, 'journalDetailFile');

            if ($model->validate()) {
                $uploadPath = Yii::getAlias('@webroot/uploads/');

                // Pastikan direktori tujuan ada, jika tidak buat baru
                if (!is_dir($uploadPath)) {
                    mkdir($uploadPath, 0777, true);
                }

                $journalFilePath = $uploadPath . $model->journalFile->name;
                $journalDetailFilePath = $uploadPath . $model->journalDetailFile->name;

                //hapus semua dulu lalu input ulang
                // JournalCompare::deleteAll();
                // DetailCompare::deleteAll();

                if ($model->journalFile->saveAs($journalFilePath) && $model->journalDetailFile->saveAs($journalDetailFilePath)) {
                    // Decode kedua file
                    $journalData = json_decode(file_get_contents($journalFilePath), true);
                    $journalDetailData = json_decode(file_get_contents($journalDetailFilePath), true);

                    if (isset($journalData['JV']) && isset($journalDetailData['JVDET'])) {
                        $filteredData = [];

                        // Gabungkan data Journal dan Journal Detail
                        foreach ($journalData['JV'] as $journal) {
                            $details = array_filter($journalDetailData['JVDET'], function ($detail) use ($journal) {
                                return $detail['JVID'] === $journal['JVID'];
                            });

                            $journalCompare = new JournalCompare();
                            $journalCompare->number = $journal['JVNUMBER'];
                            $journalCompare->transDate = date('d/m/Y', strtotime($journal['TRANSDATE']));
                            $journalCompare->description = $journal['TRANSDESCRIPTION'];
                            $journalCompare->branchName = $journal['BRANCHCODE'];
                            $journalCompare->save();
                            
                            $filteredData[] = [
                                'number' => $journal['JVNUMBER'],
                                'transDate' => date('d/m/Y', strtotime($journal['TRANSDATE'])),
                                'description' => $journal['TRANSDESCRIPTION'],
                                'branchName' => $journal['BRANCHCODE'],
                                'journaldetail' => array_values(array_map(function ($detail) {
                                    // pemetaan GLACCOUNT
                                    $hasChanged = false;
                                    $accountNoOri = $detail['GLACCOUNT']; 

                                     // Pemetaan kode akun berdasarkan aturan yang diberikan
                                    $accountMapping = [            
                                        '1000' => '1-1000',
                                        '1001' => '1-1001',
                                        '1001.01' => '1-1001.01',
                                        '1001.02' => '1-1001.02',
                                        '1001.03' => '1-1001.02', //pindah
                                        '1001.04' => '1-1001.03',
                                        '1001.04.01' => '1-1001.03.01',
                                        '1001.04.02' => '1-1001.03.02',
                                        '1001.04.03' => '1-1001.03.03',
                                        '1001.04.04' => '1-1001.03.04',
                                        '1001.04.05' => '1-1001.03.05',
                                        '1001.04.06' => '1-1001.03.06',
                                        '1001.04.07' => '1-1001.03.07',
                                        '1001.04.08' => '1-1001.03.08',
                                        '1001.04.09' => '1-1001.03.09',
                                        '1001.04.10' => '1-1001.03.10',
                                        '1001.04.11' => '1-1001.03.11',
                                        '1001.04.12' => '1-1001.03.12',
                                        '1001.04.13' => '1-1001.03.13',
                                        '1001.04.14' => '1-1001.03.14',
                                        '1001.04.15' => '1-1001.03.15',
                                        '1001.05' => '1-1001.02', //pindah
                                        '1001.06' => '1-1001.04',
                                        '1001.07' => '1-1001.02', //pindah
                                        '1001.08' => '1-1001.05',
                                        '1001.1' => '1-1001.06',
                                        '1002' => '1-1002',
                                        '1002.01' => '1-1002.01',
                                        '1002.03' => '1-1002.02',
                                        '1002.05' => '1-1002.03',
                                        '1002.06' => '1-1002.04',
                                        '1002.08' => '1-1002.08',
                                        '1002.09' => '1-1002.05',
                                        '1002.1' => '1-1002.1',
                                        '1002.10.01' => '1-1002.10.01',
                                        '1002.10.02' => '1-1002.10.02',
                                        '1002.10.03' => '1-1002.10.03',
                                        '1002.10.04' => '1-1002.10.04',
                                        '1002.10.05' => '1-1002.10.05',
                                        '1002.10.06' => '1-1002.10.06',
                                        '1002.10.07' => '1-1002.10.07',
                                        '1002.10.08' => '1-1002.10.08',
                                        '1002.11' => '1-1002.06',
                                        '1002.12' => '1-1002.16',
                                        '1002.13' => '1-1002.17',
                                        '1002.14' => '1-1002.18',
                                        '1002.15' => '1-1002.07',
                                        '1002.16' => '1-1002.09',
                                        '1002.17' => '1-1002.10',
                                        '1002.18' => '1-1002.11',
                                        '1002.19' => '1-1002.12',
                                        '1002.2' => '1-1002.10.09',
                                        '1002.22' => '1-1002.13',
                                        '1002.24' => '1-1002.14',
                                        '1002.23' => '1-1002.15',
                                        '1003' => '1-1003',
                                        '1003.01' => '1-1003.01',
                                        '1003.02' => '1-1003.02',
                                        '1003.03' => '1-1003.03',
                                        '1100' => '1-1100',
                                        '1100.01' => '1-1100.01',
                                        '1100.02' => '1-1100.02',
                                        '110302' => '1-110302',
                                        '110402' => '1-110402',
                                        '1200' => '1-1200',
                                        '1201' => '1-1201',
                                        '1300' => '1-1300',
                                        '1400' => '1-1400',
                                        '1400.01' => '1-1400.01',
                                        '1400.02' => '1-1400.02',
                                        '1400.03' => '1-1400.03',
                                        '1400.04' => '1-1400.04',
                                        '1400.05' => '1-1400.05',
                                        '1400.06' => '1-1400.06',
                                        '1400.06.01' => '1-1400.06.01',
                                        '1400.07' => '1-1400.07',
                                        '1400.07.01' => '1-1400.07.01',
                                        '1400.07.02' => '1-1400.07.02',
                                        '1400.07.03' => '1-1400.07.03',
                                        '1400.07.04' => '1-1400.07.04',
                                        '1400.07.05' => '1-1400.07.05',
                                        '1400.07.06' => '1-1400.07.06',
                                        '1400.07.07' => '1-1400.07.07',
                                        '1400.07.08' => '1-1400.07.08',
                                        '1400.08' => '1-1400.08',
                                        '1400.09' => '1-1400.09',
                                        '1400.1' => '1-1400.10',
                                        '1400.11' => '1-1400.11',
                                        '1400.12' => '1-1400.12',
                                        '1400.13' => '1-1400.13',
                                        '1400.14' => '1-1400.14',
                                        '1400.15' => '1-1400.15',
                                        '1400.16' => '1-1400.16',
                                        '1500' => '1-1500',
                                        '1500.01' => '1-1500.01',
                                        '1500.02' => '1-1500.02',
                                        '1500.03' => '1-1500.03',
                                        '1500.04' => '1-1500.04',
                                        '1500.05' => '1-1500.05',
                                        '1600' => '1-1600',
                                        '1700' => '1-1700',
                                        '1700.01' => '1-1700.01',
                                        '1700.01.01' => '1-1700.01.01',
                                        '1700.01.02' => '1-1700.01.02',
                                        '1700.01.03' => '1-1700.01.03',
                                        '1700.01.04' => '1-1700.01.04',
                                        '1700.01.05' => '1-1700.01.05',
                                        '1700.01.06' => '1-1700.01.06',
                                        '1700.01.07' => '1-1700.01.07',
                                        '1700.01.08' => '1-1700.01.08',
                                        '1700.02' => '1-1700.02',
                                        '1700.02.01' => '1-1700.02.01',
                                        '1700.02.02' => '1-1700.02.02',
                                        '1700.02.03' => '1-1700.02.03',
                                        '1700.02.04' => '1-1700.02.04',
                                        '1700.02.05' => '1-1700.02.05',
                                        '1700.02.06' => '1-1700.02.06',
                                        '1700.02.07' => '1-1700.02.07',
                                        '1700.02.08' => '1-1700.02.08',
                                        '1700.02.09' => '1-1700.02.09',
                                        '1700.02.10' => '1-1700.02.10',
                                        '1700.02.11' => '1-1700.02.11',
                                        '1700.02.12' => '1-1700.02.12',
                                        '1700.02.13' => '1-1700.02.13',
                                        '1700.02.14' => '1-1700.02.14',
                                        '1700.02.15' => '1-1700.02.15',
                                        '1700.02.15.01' => '1-1700.02.15.01',
                                        '1700.02.15.02' => '1-1700.02.15.02',
                                        '1700.02.15.03' => '1-1700.02.15.03',
                                        '1700.02.15.04' => '1-1700.02.15.04',
                                        '1700.02.15.05' => '1-1700.02.15.05',
                                        '1700.02.15.06' => '1-1700.02.15.06',
                                        '1700.02.15.07' => '1-1700.02.15.07',
                                        '1700.02.15.08' => '1-1700.02.15.08',
                                        '1700.02.16' => '1-1700.02.16',
                                        '1700.02.16.01' => '1-1700.02.16.01',
                                        '1700.02.16.02' => '1-1700.02.16.02',
                                        '1700.02.16.03' => '1-1700.02.16.03',
                                        '1700.02.17' => '1-1700.02.17',
                                        '1700.02.18' => '1-1700.02.18',
                                        '1700.02.19' => '1-1700.02.19',
                                        '1700.02.20' => '1-1700.02.20',
                                        '1700.02.21' => '1-1700.02.21',
                                        '1700.03' => '1-1700.03',
                                        '1700.03.01' => '1-1700.03.01',
                                        '1700.03.02' => '1-1700.03.02',
                                        '1700.04' => '1-1700.04',
                                        '1700.04.01' => '1-1700.04.01',
                                        '1700.04.02' => '1-1700.04.02',
                                        '1700.04.03' => '1-1700.04.03',
                                        '1700.04.04' => '1-1700.04.04',
                                        '1700.04.05' => '1-1700.04.05',
                                        '1700.04.06' => '1-1700.04.06',
                                        '1700.04.07' => '1-1700.04.07',
                                        '1700.04.08' => '1-1700.04.08',
                                        '1700.04.09' => '1-1700.04.09',
                                        '1700.04.10' => '1-1700.04.10',
                                        '1700.04.11' => '1-1700.04.11',
                                        '1700.04.12' => '1-1700.04.12',
                                        '1700.04.13' => '1-1700.04.13',
                                        '1700.04.14' => '1-1700.04.14',
                                        '1700.04.15' => '1-1700.04.15',
                                        '1700.04.16' => '1-1700.04.16',
                                        '1700.04.17' => '1-1700.04.17',
                                        '1700.04.18' => '1-1700.04.18',
                                        '1700.04.19' => '1-1700.04.19',
                                        '1700.05' => '1-1700.05',
                                        '1700.05.01' => '1-1700.05.01',
                                        '1700.1' => '1-1700.1',
                                        '1700.10.01' => '1-1700.10.01',
                                        '1710' => '1-1710',
                                        '1710.01' => '1-1710.01',
                                        '1710.01.01' => '1-1710.01.01',
                                        '1710.01.02' => '1-1710.01.02',
                                        '1710.02' => '1-1710.02',
                                        '1710.02.01' => '1-1710.02.01',
                                        '1710.02.02' => '1-1710.02.02',
                                        '1710.03' => '1-1710.03',
                                        '1710.03.01' => '1-1710.03.01',
                                        '1710.03.02' => '1-1710.03.02',
                                        '1710.03.03' => '1-1710.03.03',
                                        '1710.03.04' => '1-1710.03.04',
                                        '1710.03.05' => '1-1710.03.05',
                                        '1710.03.06' => '1-1710.03.06',
                                        '1710.03.07' => '1-1710.03.07',
                                        '1710.03.08' => '1-1710.03.08',
                                        '1710.03.09' => '1-1710.03.09',
                                        '1710.03.10' => '1-1710.03.10',
                                        '1710.03.11' => '1-1710.03.11',
                                        '1710.03.12' => '1-1710.03.12',
                                        '1710.03.13' => '1-1710.03.13',
                                        '1710.03.14' => '1-1710.03.14',
                                        '1710.03.15' => '1-1710.03.15',
                                        '1710.03.16' => '1-1710.03.16',
                                        '1710.03.17' => '1-1710.03.17',
                                        '1710.03.18' => '1-1710.03.18',
                                        '1710.03.19' => '1-1710.03.19',
                                        '1710.04' => '1-1710.04',
                                        '1710.05' => '1-1710.05',
                                        '2000' => '2-2000',
                                        '2000.01' => '2-2000.01',
                                        '2000.02' => '2-2000.02',
                                        '2000.03' => '2-2000.03',
                                        '2000.04' => '2-2000.04',
                                        '2000.05' => '2-2000.05',
                                        '210102' => '2-210102',
                                        '210202' => '2-210202',
                                        '2200' => '2-2200',
                                        '2300' => '2-2300',
                                        '2300.02' => '2-2300.01',
                                        '2300.03' => '2-2300.02',
                                        '2300.05' => '2-2300.03',
                                        '2300.07' => '2-2300.04',
                                        '2300.08' => '2-2300.05',
                                        '2300.09' => '2-2300.06',
                                        '2300.1' => '2-2300.07',
                                        '2300.11' => '2-2300.08',
                                        '2300.12' => '2-2300.09',
                                        '2300.13' => '2-2300.10',
                                        '2300.13.01' => '2-2300.10.01',
                                        '2300.14' => '2-2300.11',
                                        '2300.15' => '2-2300.12',
                                        '2300.15.01' => '2-2300.12.01',
                                        '2300.15.02' => '2-2300.12.02',
                                        '2300.15.03' => '2-2300.12.03',
                                        '2300.15.04' => '2-2300.12.04',
                                        '2300.15.05' => '2-2300.12.05',
                                        '2300.17' => '2-2300.13',
                                        '2300.18' => '2-2300.14',
                                        '2300.19' => '2-2300.15',
                                        '2300.2' => '2-2300.16',
                                        '2300.21' => '2-2300.17',
                                        '2300.22' => '2-2300.18',
                                        '2300.23' => '2-2300.19',
                                        '2300.24' => '2-2300.20',
                                        '3000' => '3-3000',
                                        '310001' => '3-310001',
                                        '320001' => '3-320001',
                                        '4000' => '4-4000',
                                        '4000.01' => '4-4000.01',
                                        '4000.01.01' => '4-4000.01.01',
                                        '4000.01.02' => '4-4000.01.02',
                                        '4000.01.03' => '4-4000.01.03',
                                        '4000.01.04' => '4-4000.01.04',
                                        '4000.01.05' => '4-4000.01.05',
                                        '4000.01.06' => '4-4000.01.06',
                                        '4000.01.07' => '4-4000.01.07',
                                        '4000.01.08' => '4-4000.01.08',
                                        '4000.01.09' => '4-4000.01.09',
                                        '4000.01.10' => '4-4000.01.10',
                                        '4000.01.11' => '4-4000.01.11',
                                        '4000.01.12' => '4-4000.01.12',
                                        '4000.01.13' => '4-4000.01.13',
                                        '4000.02' => '4-4000.02',
                                        '4000.02.01' => '4-4000.02.01',
                                        '4000.02.02' => '4-4000.02.02',
                                        '4000.02.03' => '4-4000.02.03',
                                        '4000.02.04' => '4-4000.02.04',
                                        '4000.02.05' => '4-4000.02.05',
                                        '4000.02.06' => '4-4000.02.06',
                                        '4000.02.07' => '4-4000.02.07',
                                        '4000.02.08' => '4-4000.02.08',
                                        '4000.02.09' => '4-4000.02.09',
                                        '4000.02.11' => '4-4000.02.10',
                                        '4000.02.12' => '4-4000.02.11',
                                        '4000.02.14' => '4-4000.02.12',
                                        '4000.02.15' => '4-4000.02.13',
                                        '4000.03' => '4-4000.03',
                                        '4000.03.01' => '4-4000.03.01',
                                        '4000.03.02' => '4-4000.03.02',
                                        '4000.03.03' => '4-4000.03.03',
                                        '4000.03.04' => '4-4000.03.04',
                                        '4000.03.05' => '4-4000.03.05',
                                        '4000.03.06' => '4-4000.03.06',
                                        '4000.03.07' => '4-4000.03.07',
                                        '4000.03.08' => '4-4000.03.08',
                                        '4000.03.09' => '4-4000.03.09',
                                        '4000.03.10' => '4-4000.03.10',
                                        '4000.04' => '4-4000.04',
                                        '4000.04.01' => '4-4000.04.01',
                                        '4000.04.01.01' => '4-4000.04.01.01',
                                        '4000.04.01.02' => '4-4000.04.01.02',
                                        '4000.04.01.03' => '4-4000.04.01.03',
                                        '4000.04.01.04' => '4-4000.04.01.04',
                                        '4000.04.01.05' => '4-4000.04.01.05',
                                        '4000.04.02' => '4-4000.04.02',
                                        '4000.04.03' => '4-4000.04.03',
                                        '4000.04.05' => '4-4000.04.04',
                                        '4000.04.06' => '4-4000.04.05',
                                        '4000.04.07' => '4-4000.04.06',
                                        '4000.04.08' => '4-4000.04.07',
                                        '4000.04.09' => '4-4000.04.08',
                                        '4000.04.10' => '4-4000.04.09',
                                        '4000.05' => '4-4000.05',
                                        '4000.06' => '4-4000.06',
                                        '4000.07' => '4-4000.07',
                                        '4000.08' => '4-4000.08',
                                        '4000.08.01' => '4-4000.08.01',
                                        '4000.08.02' => '4-4000.08.02',
                                        '4000.08.03' => '4-4000.08.03',
                                        '4000.09' => '4-4000.09',
                                        '4000.1' => '4-4000.10',
                                        '4000.11' => '4-4000.11',
                                        '4000.11.01' => '4-4000.11.01',
                                        '4000.11.02' => '4-4000.11.02',
                                        '4000.11.03' => '4-4000.11.03',
                                        '4000.11.04' => '4-4000.11.04',
                                        '4000.11.05' => '4-4000.11.05',
                                        '4000.12' => '4-4000.12',
                                        '4000.12.01' => '4-4000.12.01',
                                        '4000.12.02' => '4-4000.12.02',
                                        '4000.12.03' => '4-4000.12.03',
                                        '4000.12.04' => '4-4000.12.04',
                                        '4000.12.05' => '4-4000.12.05',
                                        '4000.12.06' => '4-4000.12.06',
                                        '4000.12.07' => '4-4000.12.07',
                                        '4000.12.08' => '4-4000.12.08',
                                        '4000.12.09' => '4-4000.12.09',
                                        '4000.13' => '4-4000.13',
                                        '4000.14' => '4-4000.14',
                                        '4000.15' => '4-4000.15',
                                        '4000.15.01' => '4-4000.15.01',
                                        '4000.15.02' => '4-4000.15.02',
                                        '5000' => '5-5000',
                                        '6000' => '6-6000',
                                        '6000.01' => '6-6000.01',
                                        '6000.02' => '6-6000.02',
                                        '6000.03' => '6-6000.03',
                                        '6000.04' => '6-6000.04',
                                        '6001' => '6-6001',
                                        '6001.01' => '6-6001.01',
                                        '6001.02' => '6-6001.02',
                                        '6001.03' => '6-6001.03',
                                        '6002' => '6-6002',
                                        '6002.01' => '6-6002.01',
                                        '6100' => '6-6100',
                                        '6100.01' => '6-6100.01',
                                        '6100.02' => '6-6100.02',
                                        '6100.03' => '6-6100.03',
                                        '6200' => '6-6200',
                                        '6201' => '6-6201',
                                        '6201.01' => '6-6201.01',
                                        '6201.01.1' => '6-6201.01.01',
                                        '6201.02' => '6-6201.02',
                                        '6201.02.01' => '6-6201.02.01',
                                        '6201.02.02' => '6-6201.02.02',
                                        '6201.02.03' => '6-6201.02.03',
                                        '6201.02.04' => '6-6201.02.04',
                                        '6201.02.06' => '6-6201.02.05',
                                        '6201.02.07' => '6-6201.02.06',
                                        '6202' => '6-6202',
                                        '6202.01' => '6-6202.01',
                                        '6202.02' => '6-6202.02',
                                        '6202.03' => '6-6202.03',
                                        '6202.04' => '6-6202.04',
                                        '6202.05' => '6-6202.05',
                                        '6203' => '6-6203',
                                        '6203.01' => '6-6203.01',
                                        '6203.02' => '6-6203.02',
                                        '6203.03' => '6-6203.03',
                                        '6203.04' => '6-6203.04',
                                        '6203.04.01' => '6-6203.04.01',
                                        '6203.04.02' => '6-6203.04.02',
                                        '6203.04.03' => '6-6203.04.03',
                                        '6203.04.04' => '6-6203.04.04',
                                        '6203.04.05' => '6-6203.04.05',
                                        '6203.04.06' => '6-6203.04.06',
                                        '6203.04.07' => '6-6203.04.07',
                                        '6203.04.08' => '6-6203.04.08',
                                        '6203.05' => '6-6203.05',
                                        '6204' => '6-6204',
                                        '6204.01' => '6-6204.01',
                                        '6204.02' => '6-6204.02',
                                        '6204.03' => '6-6204.03',
                                        '6204.04' => '6-6204.04',
                                        '6204.05' => '6-6204.05',
                                        '6204.06' => '6-6204.06',
                                        '6204.07' => '6-6204.07',
                                        '6204.08' => '6-6204.08',
                                        '6204.09' => '6-6204.09',
                                        '6204.1' => '6-6204.10',
                                        '6204.11' => '6-6204.11',
                                        '6204.12' => '6-6204.12',
                                        '6204.13' => '6-6204.13',
                                        '6204.14' => '6-6204.14',
                                        '6204.15' => '6-6204.15',
                                        '6205' => '6-6205',
                                        '6205.01' => '6-6205.01',
                                        '6205.02' => '6-6205.02',
                                        '6205.03' => '6-6205.03',
                                        '6205.04' => '6-6205.04',
                                        '6206' => '6-6206',
                                        '6206.01' => '6-6206.01',
                                        '6206.02' => '6-6206.02',
                                        '6206.03' => '6-6206.03',
                                        '6206.04' => '6-6206.04',
                                        '6206.05' => '6-6206.05',
                                        '6206.07' => '6-6206.06',
                                        '6207' => '6-6207',
                                        '6207.01' => '6-6207.01',
                                        '6207.02' => '6-6207.02',
                                        '6207.02.01' => '6-6207.02.01',
                                        '6207.02.02' => '6-6207.02.02',
                                        '6207.02.03' => '6-6207.02.03',
                                        '6207.02.04' => '6-6207.02.04',
                                        '6207.02.05' => '6-6207.02.05',
                                        '6208' => '6-6208',
                                        '6208.01' => '6-6208.01',
                                        '6208.02' => '6-6208.02',
                                        '6208.03' => '6-6208.03',
                                        '6208.03.01' => '6-6208.03.01',
                                        '6208.03.02' => '6-6208.03.02',
                                        '6208.03.05' => '6-6208.03.03',
                                        '6208.03.06' => '6-6208.03.04',
                                        '6208.03.07' => '6-6208.03.05',
                                        '6208.03.08' => '6-6208.03.06',
                                        '6208.03.09' => '6-6208.03.07',
                                        '6208.03.10' => '6-6208.03.08',
                                        '6208.03.11' => '6-6208.03.09',
                                        '6208.03.12' => '6-6208.03.10',
                                        '6208.03.13' => '6-6208.03.11',
                                        '6208.03.14' => '6-6208.03.12',
                                        '6208.03.15' => '6-6208.03.13',
                                        '6208.03.16' => '6-6208.03.14',
                                        '6208.03.17' => '6-6208.03.15',
                                        '6208.03.18' => '6-6208.03.16',
                                        '6208.03.19' => '6-6208.03.17',
                                        '6208.03.20' => '6-6208.03.18',
                                        '6208.03.21' => '6-6208.03.19',
                                        '6208.03.22' => '6-6208.03.20',
                                        '6208.03.24' => '6-6208.03.21',
                                        '6208.03.25' => '6-6208.03.22',
                                        '6208.03.26' => '6-6208.03.23',
                                        '6208.03.27' => '6-6208.03.24',
                                        '6208.03.28' => '6-6208.03.25',
                                        '6208.03.29' => '6-6208.03.26',
                                        '6208.03.30' => '6-6208.03.27',
                                        '6208.03.31' => '6-6208.03.28',
                                        '6208.03.32' => '6-6208.03.29',
                                        '6208.04' => '6-6208.04',
                                        '6208.05' => '6-6208.05',
                                        '6208.06' => '6-6208.06',
                                        '6208.07' => '6-6208.07',
                                        '6208.07.01' => '6-6208.07.01',
                                        '6208.07.02' => '6-6208.07.02',
                                        '6208.07.03' => '6-6208.07.03',
                                        '6208.07.04' => '6-6208.07.04',
                                        '6208.07.05' => '6-6208.07.05',
                                        '6208.07.06' => '6-6208.07.06',
                                        '6208.07.07' => '6-6208.07.07',
                                        '6208.08' => '6-6208.08',
                                        '6209' => '6-6209',
                                        '6210' => '6-6210',
                                        '6210.01' => '6-6210.01',
                                        '6210.02' => '6-6210.02',
                                        '6210.03' => '6-6210.03',
                                        '6211' => '6-6211',
                                        '6211.01' => '6-6211.01',
                                        '6211.02' => '6-6211.02',
                                        '6211.03' => '6-6211.03',
                                        '6211.04' => '6-6211.04',
                                        '6211.05' => '6-6211.05',
                                        '6211.06' => '6-6211.06',
                                        '6211.07' => '6-6211.07',
                                        '6213' => '6-6212',
                                        '6213.01' => '6-6212.01',
                                        '6213.01.01' => '6-6212.01.01',
                                        '6213.01.02' => '6-6212.01.02',
                                        '6213.01.03' => '6-6212.01.03',
                                        '6213.01.04' => '6-6212.01.04',
                                        '6213.01.05' => '6-6212.01.05',
                                        '6213.01.06' => '6-6212.01.06',
                                        '6213.01.07' => '6-6212.01.07',
                                        '6213.01.08' => '6-6212.01.08',
                                        '6213.01.09' => '6-6212.01.09',
                                        '6213.01.10' => '6-6212.01.10',
                                        '6213.02' => '6-6212.02',
                                        '6213.02.01' => '6-6212.02.01',
                                        '6213.02.02' => '6-6212.02.02',
                                        '6213.02.03' => '6-6212.02.03',
                                        '6213.02.04' => '6-6212.02.04',
                                        '6213.02.05' => '6-6212.02.05',
                                        '6213.02.06' => '6-6212.02.06',
                                        '6213.02.07' => '6-6212.02.07',
                                        '6213.02.08' => '6-6212.02.08',
                                        '6213.02.09' => '6-6212.02.09',
                                        '6213.02.10' => '6-6212.02.10',
                                        '6213.02.11' => '6-6212.02.11',
                                        '6213.02.12' => '6-6212.02.12',
                                        '6213.02.13' => '6-6212.02.13',
                                        '6213.02.14' => '6-6212.02.14',
                                        '6213.02.14.01' => '6-6212.02.14.01', 
                                        '6213.02.14.02' => '6-6212.02.14.02',
                                        '6213.02.14.03' => '6-6212.02.14.03',
                                        '6213.02.14.04' => '6-6212.02.14.04',
                                        '6213.02.14.05' => '6-6212.02.14.05',
                                        '6213.02.14.06' => '6-6212.02.14.06',
                                        '6213.02.14.07' => '6-6212.02.14.07',
                                        '6213.02.14.08' => '6-6212.02.14.08',
                                        '6213.02.14.09' => '6-6212.02.14.09',
                                        '6213.02.15' => '6-6212.02.15',
                                        '6213.03' => '6-6212.03',
                                        '6213.03.01' => '6-6212.03.01',
                                        '6213.03.02' => '6-6212.03.02',
                                        '6213.03.03' => '6-6212.03.03',
                                        '6213.04' => '6-6212.04',
                                        '6213.04.01' => '6-6212.04.01',
                                        '6213.04.02' => '6-6212.04.02',
                                        '6213.04.03' => '6-6212.04.03',
                                        '6213.04.04' => '6-6212.04.04',
                                        '6213.04.05' => '6-6212.04.05',
                                        '6213.04.06' => '6-6212.04.06',
                                        '6213.04.07' => '6-6212.04.07',
                                        '6213.04.08' => '6-6212.04.08',
                                        '6213.04.09' => '6-6212.04.09',
                                        '6213.04.10' => '6-6212.04.10',
                                        '6213.04.11' => '6-6212.04.11',
                                        '6213.04.12' => '6-6212.04.12',
                                        '6213.04.13' => '6-6212.04.13',
                                        '6213.04.14' => '6-6212.04.14',
                                        '6213.04.15' => '6-6212.04.15',
                                        '6213.04.16' => '6-6212.04.16',
                                        '6213.05' => '6-6212.05',
                                        '6213.05.01' => '6-6212.05.01',
                                        '6213.05.02' => '6-6212.05.02',
                                        '6214' => '6-6213',
                                        '6214.01' => '6-6213.01',
                                        '6214.01.01' => '6-6213.01.01',
                                        '6214.01.02' => '6-6213.01.02',
                                        '6214.01.03' => '6-6213.01.03',
                                        '6214.01.04' => '6-6213.01.04',
                                        '6214.01.05' => '6-6213.01.05',
                                        '6214.01.06' => '6-6213.01.06',
                                        '6214.01.07' => '6-6213.01.07',
                                        '6214.01.08' => '6-6213.01.08',
                                        '6214.01.09' => '6-6213.01.09',
                                        '6214.02' => '6-6213.02',
                                        '6214.02.01' => '6-6213.02.01',
                                        '6214.02.02' => '6-6213.02.02',
                                        '6214.02.03' => '6-6213.02.03',
                                        '6214.02.04' => '6-6213.02.04',
                                        '6214.03' => '6-6213.03',
                                        '6214.03.01' => '6-6213.03.01',
                                        '6214.03.02' => '6-6213.03.02',
                                        '6214.04' => '6-6213.04',
                                        '6214.04.01' => '6-6213.04.01',
                                        '6213.04.01.01' => '6-6213.04.01.01',
                                        '6213.04.01.02' => '6-6213.04.01.02',
                                        '6213.04.01.03' => '6-6213.04.01.03',
                                        '6213.04.01.04' => '6-6213.04.01.04',
                                        '6213.04.01.05' => '6-6213.04.01.05',
                                        '6213.04.01.06' => '6-6213.04.01.06',
                                        '6213.04.01.07' => '6-6213.04.01.07',
                                        '6213.04.01.08' => '6-6213.04.01.08',
                                        '6213.04.01.09' => '6-6213.04.01.09',
                                        '6213.04.01.10' => '6-6213.04.01.10',
                                        '6213.04.01.11' => '6-6213.04.01.11',
                                        '6213.04.01.12' => '6-6213.04.01.12',
                                        '6213.04.01.13' => '6-6213.04.01.13',
                                        '6213.04.01.14' => '6-6213.04.01.14',
                                        '6213.04.01.15' => '6-6213.04.01.15',
                                        '6213.04.01.16' => '6-6213.04.01.16',
                                        '6213.04.01.17' => '6-6213.04.01.17',
                                        '6213.04.01.18' => '6-6213.04.01.18',
                                        '6214.04.02' => '6-6213.04.02',
                                        '6213.04.02.01' => '6-6213.04.02.01',
                                        '6213.04.02.02' => '6-6213.04.02.02',
                                        '6213.04.02.03' => '6-6213.04.02.03',
                                        '6213.04.02.04' => '6-6213.04.02.04',
                                        '6213.04.02.05' => '6-6213.04.02.05',
                                        '6213.04.02.06' => '6-6213.04.02.06',
                                        '6213.04.02.07' => '6-6213.04.02.07',
                                        '6213.04.02.08' => '6-6213.04.02.08',
                                        '6213.04.02.09' => '6-6213.04.02.09',
                                        '6213.04.02.10' => '6-6213.04.02.10',
                                        '6213.04.02.11' => '6-6213.04.02.11',
                                        '6213.04.02.12' => '6-6213.04.02.12',
                                        '6213.04.02.13' => '6-6213.04.02.13',
                                        '6214.04.03' => '6-6213.04.03',
                                        '6214.04.04' => '6-6213.04.04',
                                        '6214.05' => '6-6213.05',
                                        '6214.05.01' => '6-6213.05.01',
                                        '6214.05.02' => '6-6213.05.02',
                                        '6214.05.03' => '6-6213.05.03',
                                        '6214.05.04' => '6-6213.05.04',
                                        '6214.05.05' => '6-6213.05.05',
                                        '6214.05.06' => '6-6213.05.02', //pindah ke 6-6213.05.02
                                        '6214.05.07' => '6-6213.05.06',
                                        '6214.05.08' => '6-6213.05.07',
                                        '6214.06' => '6-6213.06',
                                        '6214.06.01' => '6-6213.06.01',
                                        '6214.06.02' => '6-6213.06.02',
                                        '6214.06.03' => '6-6213.06.03',
                                        '6214.06.04' => '6-6213.06.04',
                                        '6215' => '6-6214',
                                        '6215.01' => '6-6214.01',
                                        '6215.01.01' => '6-6214.01.01', //pindah ke 6-6214.01.01
                                        '6215.01.02' => '6-6214.01.01', //pindah ke 6-6214.01.01
                                        '6215.01.03' => '6-6214.01.01', //pindah ke 6-6214.01.01  
                                        '6215.01.04' => '6-6214.01.01',
                                        '6215.02' => '6-6214.02',
                                        '6216' => '6-6215',
                                        '6216.01' => '6-6215.01',
                                        '6216.01.01' => '6-6215.01.01', //pindah ke 6-6215.01.01
                                        '6216.01.02' => '6-6215.01.01', //pindah ke 6-6215.01.01
                                        '6216.01.03' => '6-6215.01.01', //pindah ke 6-6215.01.01
                                        '6216.01.04' => '6-6215.01.01',
                                        '6216.02' => '6-6215.02',
                                        '6216.02.01' => '6-6215.02.01',
                                        '6216.02.02' => '6-6215.02.02',
                                        '6216.02.03' => '6-6215.02.03',
                                        '6217' => '6-6216',
                                        '6217.01' => '6-6216.01', //pindah ke 6-6216.01
                                        '6217.02' => '6-6216.01', //pindah ke 6-6216.01
                                        '6217.03' => '6-6216.01', //pindah ke 6-6216.01
                                        '6217.04' => '6-6216.01',
                                        '6217.05' => '6-6216.01', //pindah ke 6-6216.01
                                        '6217.06' => '6-6216.01', //pindah ke 6-6216.01
                                        '6217.07' => '6-6216.01', //pindah ke 6-6216.01
                                        '6218' => '6-6217',
                                        '6218.01' => '6-6217.01',
                                        '6218.02' => '6-6217.02',
                                        '6218.03' => '6-6217.03',
                                        '6218.04' => '6-6217.04',
                                        '6218.05' => '6-6217.05',
                                        '6219' => '6-6218',
                                        '6219.01' => '6-6218.01',
                                        '6219.02' => '6-6218.02',
                                        '6219.03' => '6-6218.03',
                                        '6219.04' => '6-6218.04',
                                        '6219.05' => '6-6218.05',
                                        '6219.05.01' => '6-6218.05.01',
                                        '6219.05.02' => '6-6218.05.02',
                                        '6219.05.03' => '6-6218.05.03',
                                        '6219.05.04' => '6-6218.05.04',
                                        '6219.05.05' => '6-6218.05.05',
                                        '6219.05.06' => '6-6218.05.06',
                                        '6219.05.07' => '6-6218.05.07',
                                        '6219.05.08' => '6-6218.05.08',
                                        '6219.05.09' => '6-6218.05.09',
                                        '6219.05.11' => '6-6218.05.10',
                                        '6219.05.12' => '6-6218.05.11',
                                        '6219.05.13' => '6-6218.05.12',
                                        '6219.05.14' => '6-6218.05.13',
                                        '6219.06' => '6-6218.06',
                                        '6219.06.01' => '6-6218.06.01',
                                        '6219.06.02' => '6-6218.06.02',
                                        '6219.06.03' => '6-6218.06.03',
                                        '6219.06.04' => '6-6218.06.04',
                                        '6219.07' => '6-6218.07',
                                        '6219.08' => '6-6218.08',
                                        '6219.08.01' => '6-6218.08.01',
                                        '6219.08.02' => '6-6218.08.02',
                                        '6219.08.03' => '6-6218.08.03',
                                        '6219.09' => '6-6218.09',
                                        '6219.1' => '6-6218.10',
                                        '6219.11' => '6-6218.11',
                                        '6219.12' => '6-6218.12',
                                        '6219.12.01' => '6-6218.12.01',
                                        '6219.12.02' => '6-6218.12.02',
                                        '6219.12.03' => '6-6218.12.03',
                                        '6219.13' => '6-6218.13',
                                        '6219.13.01' => '6-6218.13.01',
                                        '6219.13.01.01' => '6-6218.13.01.01',
                                        '6219.13.01.02' => '6-6218.13.01.02',
                                        '6219.13.01.03' => '6-6218.13.01.03',
                                        '6219.13.01.04' => '6-6218.13.01.04',
                                        '6219.13.02' => '6-6218.13.02',
                                        '6219.13.03' => '6-6218.13.03',
                                        '6219.13.03.01' => '6-6218.13.03.01',
                                        '6219.13.03.02' => '6-6218.13.03.02',
                                        '6219.13.03.03' => '6-6218.13.03.03',
                                        '6219.13.04' => '6-6218.13.04',
                                        '6219.13.04.01' => '6-6218.13.04.01',
                                        '6219.13.04.02' => '6-6218.13.04.02',
                                        '6219.13.04.03' => '6-6218.13.04.03',
                                        '6219.16' => '6-6218.13.05',
                                        '6219.16.01' => '6-6218.13.01',
                                        '6219.16.02' => '6-6218.13.02',
                                        '6219.16.03' => '6-6218.13.03',
                                        '6219.14' => '6-6218.14',
                                        '6219.14.01' => '6-6218.14.01',
                                        '6219.14.02' => '6-6218.14.02',
                                        '6219.14.03' => '6-6218.14.03',
                                        '6219.15' => '6-6218.15',
                                        '6220' => '6-6219',
                                        '6220.01' => '6-6219.01',
                                        '6220.02' => '6-6219.02',
                                        '6220.03' => '6-6219.03',
                                        '6220.05' => '6-6219.04',
                                        '6220.05.01' => '6-6219.04.01',
                                        '6220.05.02' => '6-6219.04.02',
                                        '6220.06' => '6-6219.05',
                                        '6221' => '6-6220',
                                        '6221.01' => '6-6220.01',
                                        '6221.02' => '6-6220.02',
                                        '6221.03' => '6-6220.03',
                                        '6221.04' => '6-6220.04',
                                        '6221.04.01' => '6-6220.04.01',
                                        '6221.04.03' => '6-6220.04.02',
                                        '6221.04.04' => '6-6220.04.03',
                                        '6221.04.05' => '6-6220.04.04',
                                        '6221.04.06' => '6-6220.04.05',
                                        '6221.05' => '6-6220.05',
                                        '6221.06' => '6-6220.06',
                                        '6222' => '6-6221',
                                        '6222.01' => '6-6221.01',
                                        '6222.02' => '6-6221.02',
                                        '6223' => '6-6222',
                                        '6223.01' => '6-6222.01',
                                        '6224' => '6-6223',
                                        '6224.01' => '6-6223.01',
                                        '6224.02' => '6-6223.02',
                                        '6224.03' => '6-6223.03',
                                        '6224.04' => '6-6223.04',
                                        '6224.05' => '6-6223.05',
                                        '6224.06' => '6-6223.06',
                                        '6224.07' => '6-6223.07',
                                        '6224.08' => '6-6223.08',
                                        '6224.08.01' => '6-6223.08.01',
                                        '6224.08.02' => '6-6223.08.02',
                                        '6225' => '6-6224',
                                        '6225.01' => '6-6224.01',
                                        '6225.02' => '6-6224.02',
                                        '6225.03' => '6-6224.03',
                                        '6225.04' => '6-6224.04',
                                        '6225.05' => '6-6224.05',
                                        '6225.06' => '6-6224.06',
                                        '6225.06.1' => '6-6224.06.01',
                                        '6225.07' => '6-6224.07',
                                        '6225.08' => '6-6224.08',
                                        '6225.1' => '6-6224.09',
                                        '6225.11' => '6-6224.10',
                                        '6226' => '6-6225',
                                        '6226.01' => '6-6225.01',
                                        '6226.02' => '7-7200.02', //pindah ke 7-7200.02
                                        '6226.03' => '6-6225.02',
                                        '6226.04' => '6-6225.03',
                                        '6226.05' => '6-6225.04',
                                        '6227' => '6-6226',
                                        '6227.01' => '6-6226.01',
                                        '6227.02' => '6-6226.02',
                                        '6228' => '6-6227',
                                        '6228.01' => '6-6227.01',
                                        '6228.02' => '6-6227.02',
                                        '6229' => '6-6228',
                                        '6230' => '6-6229',
                                        '6230.01' => '6-6229.01',
                                        '6300' => '6-6230',
                                        '6300.01' => '6-6230.01',
                                        '6300.02' => '6-6230.02',
                                        '6300.03' => '6-6230.03',
                                        '6300.04' => '6-6230.04',
                                        '6300.05' => '6-6230.05',
                                        '6300.06' => '6-6230.06',
                                        '6400' => '6-6231',
                                        '7100' => '7-7100',
                                        '7100.01' => '7-7100.01',
                                        '7100.02' => '7-7100.02',
                                        '7100.03' => '7-7100.03',
                                        '7100.04' => '7-7100.04',
                                        '7100.05' => '7-7100.05',
                                        '4000.16.01' => '4-4000.16.01',
                                        '7200' => '7-7200',
                                        '7200.01' => '7-7200.01',
                                        '7200.02' => '7-7200.02',
                                        '7200.03' => '7-7200.03',
                                        '7200.04' => '7-7200.04',
                                        '7200.05' => '7-7200.05',
                                        '8100' => '8-8100',
                                        '8200' => '8-8200',
                                        '910002' => '9-910002',
                                        '910003' => '9-910003',
                                    ];

                                    if (isset($accountMapping[$accountNoOri])) {
                                        $detail['GLACCOUNT'] = $accountMapping[$accountNoOri];
                                        $hasChanged = true;
                                    }

                                    return [
                                        'accountNo' => $detail['GLACCOUNT'],
                                        'accountOri' => $accountNoOri,
                                        'amount' => (double)(str_replace('-', '', $detail['GLAMOUNT'])),
                                        'amountType' => isset($detail['SEQ']) && $detail['SEQ'] == 1 ? 'CREDIT' : 'DEBIT',
                                        'memo' => $detail['DESCRIPTION'],
                                        'vendorNo' => $detail['SUBSIDIARY'] ?? "",
                                        'hasChanged' => $hasChanged
                                    ];
                                }, $details)),
                            ];

                            foreach ($details as $detail) {
                                $detailCompare = new DetailCompare();

                                $accountNoOri = $detail['GLACCOUNT']; 
                                // Pemetaan kode akun berdasarkan aturan yang diberikan
                                $accountMapping = [            
                                    '1000' => '1-1000',
                                    '1001' => '1-1001',
                                    '1001.01' => '1-1001.01',
                                    '1001.02' => '1-1001.02',
                                    '1001.03' => '1-1001.02', //pindah
                                    '1001.04' => '1-1001.03',
                                    '1001.04.01' => '1-1001.03.01',
                                    '1001.04.02' => '1-1001.03.02',
                                    '1001.04.03' => '1-1001.03.03',
                                    '1001.04.04' => '1-1001.03.04',
                                    '1001.04.05' => '1-1001.03.05',
                                    '1001.04.06' => '1-1001.03.06',
                                    '1001.04.07' => '1-1001.03.07',
                                    '1001.04.08' => '1-1001.03.08',
                                    '1001.04.09' => '1-1001.03.09',
                                    '1001.04.10' => '1-1001.03.10',
                                    '1001.04.11' => '1-1001.03.11',
                                    '1001.04.12' => '1-1001.03.12',
                                    '1001.04.13' => '1-1001.03.13',
                                    '1001.04.14' => '1-1001.03.14',
                                    '1001.04.15' => '1-1001.03.15',
                                    '1001.05' => '1-1001.02', //pindah
                                    '1001.06' => '1-1001.04',
                                    '1001.07' => '1-1001.02', //pindah
                                    '1001.08' => '1-1001.05',
                                    '1001.1' => '1-1001.06',
                                    '1002' => '1-1002',
                                    '1002.01' => '1-1002.01',
                                    '1002.03' => '1-1002.02',
                                    '1002.05' => '1-1002.03',
                                    '1002.06' => '1-1002.04',
                                    '1002.08' => '1-1002.08',
                                    '1002.09' => '1-1002.05',
                                    '1002.1' => '1-1002.1',
                                    '1002.10.01' => '1-1002.10.01',
                                    '1002.10.02' => '1-1002.10.02',
                                    '1002.10.03' => '1-1002.10.03',
                                    '1002.10.04' => '1-1002.10.04',
                                    '1002.10.05' => '1-1002.10.05',
                                    '1002.10.06' => '1-1002.10.06',
                                    '1002.10.07' => '1-1002.10.07',
                                    '1002.10.08' => '1-1002.10.08',
                                    '1002.11' => '1-1002.06',
                                    '1002.12' => '1-1002.16',
                                    '1002.13' => '1-1002.17',
                                    '1002.14' => '1-1002.18',
                                    '1002.15' => '1-1002.07',
                                    '1002.16' => '1-1002.09',
                                    '1002.17' => '1-1002.10',
                                    '1002.18' => '1-1002.11',
                                    '1002.19' => '1-1002.12',
                                    '1002.2' => '1-1002.10.09',
                                    '1002.22' => '1-1002.13',
                                    '1002.24' => '1-1002.14',
                                    '1002.23' => '1-1002.15',
                                    '1003' => '1-1003',
                                    '1003.01' => '1-1003.01',
                                    '1003.02' => '1-1003.02',
                                    '1003.03' => '1-1003.03',
                                    '1100' => '1-1100',
                                    '1100.01' => '1-1100.01',
                                    '1100.02' => '1-1100.02',
                                    '110302' => '1-110302',
                                    '110402' => '1-110402',
                                    '1200' => '1-1200',
                                    '1201' => '1-1201',
                                    '1300' => '1-1300',
                                    '1400' => '1-1400',
                                    '1400.01' => '1-1400.01',
                                    '1400.02' => '1-1400.02',
                                    '1400.03' => '1-1400.03',
                                    '1400.04' => '1-1400.04',
                                    '1400.05' => '1-1400.05',
                                    '1400.06' => '1-1400.06',
                                    '1400.06.01' => '1-1400.06.01',
                                    '1400.07' => '1-1400.07',
                                    '1400.07.01' => '1-1400.07.01',
                                    '1400.07.02' => '1-1400.07.02',
                                    '1400.07.03' => '1-1400.07.03',
                                    '1400.07.04' => '1-1400.07.04',
                                    '1400.07.05' => '1-1400.07.05',
                                    '1400.07.06' => '1-1400.07.06',
                                    '1400.07.07' => '1-1400.07.07',
                                    '1400.07.08' => '1-1400.07.08',
                                    '1400.08' => '1-1400.08',
                                    '1400.09' => '1-1400.09',
                                    '1400.1' => '1-1400.10',
                                    '1400.11' => '1-1400.11',
                                    '1400.12' => '1-1400.12',
                                    '1400.13' => '1-1400.13',
                                    '1400.14' => '1-1400.14',
                                    '1400.15' => '1-1400.15',
                                    '1400.16' => '1-1400.16',
                                    '1500' => '1-1500',
                                    '1500.01' => '1-1500.01',
                                    '1500.02' => '1-1500.02',
                                    '1500.03' => '1-1500.03',
                                    '1500.04' => '1-1500.04',
                                    '1500.05' => '1-1500.05',
                                    '1600' => '1-1600',
                                    '1700' => '1-1700',
                                    '1700.01' => '1-1700.01',
                                    '1700.01.01' => '1-1700.01.01',
                                    '1700.01.02' => '1-1700.01.02',
                                    '1700.01.03' => '1-1700.01.03',
                                    '1700.01.04' => '1-1700.01.04',
                                    '1700.01.05' => '1-1700.01.05',
                                    '1700.01.06' => '1-1700.01.06',
                                    '1700.01.07' => '1-1700.01.07',
                                    '1700.01.08' => '1-1700.01.08',
                                    '1700.02' => '1-1700.02',
                                    '1700.02.01' => '1-1700.02.01',
                                    '1700.02.02' => '1-1700.02.02',
                                    '1700.02.03' => '1-1700.02.03',
                                    '1700.02.04' => '1-1700.02.04',
                                    '1700.02.05' => '1-1700.02.05',
                                    '1700.02.06' => '1-1700.02.06',
                                    '1700.02.07' => '1-1700.02.07',
                                    '1700.02.08' => '1-1700.02.08',
                                    '1700.02.09' => '1-1700.02.09',
                                    '1700.02.10' => '1-1700.02.10',
                                    '1700.02.11' => '1-1700.02.11',
                                    '1700.02.12' => '1-1700.02.12',
                                    '1700.02.13' => '1-1700.02.13',
                                    '1700.02.14' => '1-1700.02.14',
                                    '1700.02.15' => '1-1700.02.15',
                                    '1700.02.15.01' => '1-1700.02.15.01',
                                    '1700.02.15.02' => '1-1700.02.15.02',
                                    '1700.02.15.03' => '1-1700.02.15.03',
                                    '1700.02.15.04' => '1-1700.02.15.04',
                                    '1700.02.15.05' => '1-1700.02.15.05',
                                    '1700.02.15.06' => '1-1700.02.15.06',
                                    '1700.02.15.07' => '1-1700.02.15.07',
                                    '1700.02.15.08' => '1-1700.02.15.08',
                                    '1700.02.16' => '1-1700.02.16',
                                    '1700.02.16.01' => '1-1700.02.16.01',
                                    '1700.02.16.02' => '1-1700.02.16.02',
                                    '1700.02.16.03' => '1-1700.02.16.03',
                                    '1700.02.17' => '1-1700.02.17',
                                    '1700.02.18' => '1-1700.02.18',
                                    '1700.02.19' => '1-1700.02.19',
                                    '1700.02.20' => '1-1700.02.20',
                                    '1700.02.21' => '1-1700.02.21',
                                    '1700.03' => '1-1700.03',
                                    '1700.03.01' => '1-1700.03.01',
                                    '1700.03.02' => '1-1700.03.02',
                                    '1700.04' => '1-1700.04',
                                    '1700.04.01' => '1-1700.04.01',
                                    '1700.04.02' => '1-1700.04.02',
                                    '1700.04.03' => '1-1700.04.03',
                                    '1700.04.04' => '1-1700.04.04',
                                    '1700.04.05' => '1-1700.04.05',
                                    '1700.04.06' => '1-1700.04.06',
                                    '1700.04.07' => '1-1700.04.07',
                                    '1700.04.08' => '1-1700.04.08',
                                    '1700.04.09' => '1-1700.04.09',
                                    '1700.04.10' => '1-1700.04.10',
                                    '1700.04.11' => '1-1700.04.11',
                                    '1700.04.12' => '1-1700.04.12',
                                    '1700.04.13' => '1-1700.04.13',
                                    '1700.04.14' => '1-1700.04.14',
                                    '1700.04.15' => '1-1700.04.15',
                                    '1700.04.16' => '1-1700.04.16',
                                    '1700.04.17' => '1-1700.04.17',
                                    '1700.04.18' => '1-1700.04.18',
                                    '1700.04.19' => '1-1700.04.19',
                                    '1700.05' => '1-1700.05',
                                    '1700.05.01' => '1-1700.05.01',
                                    '1700.1' => '1-1700.1',
                                    '1700.10.01' => '1-1700.10.01',
                                    '1710' => '1-1710',
                                    '1710.01' => '1-1710.01',
                                    '1710.01.01' => '1-1710.01.01',
                                    '1710.01.02' => '1-1710.01.02',
                                    '1710.02' => '1-1710.02',
                                    '1710.02.01' => '1-1710.02.01',
                                    '1710.02.02' => '1-1710.02.02',
                                    '1710.03' => '1-1710.03',
                                    '1710.03.01' => '1-1710.03.01',
                                    '1710.03.02' => '1-1710.03.02',
                                    '1710.03.03' => '1-1710.03.03',
                                    '1710.03.04' => '1-1710.03.04',
                                    '1710.03.05' => '1-1710.03.05',
                                    '1710.03.06' => '1-1710.03.06',
                                    '1710.03.07' => '1-1710.03.07',
                                    '1710.03.08' => '1-1710.03.08',
                                    '1710.03.09' => '1-1710.03.09',
                                    '1710.03.10' => '1-1710.03.10',
                                    '1710.03.11' => '1-1710.03.11',
                                    '1710.03.12' => '1-1710.03.12',
                                    '1710.03.13' => '1-1710.03.13',
                                    '1710.03.14' => '1-1710.03.14',
                                    '1710.03.15' => '1-1710.03.15',
                                    '1710.03.16' => '1-1710.03.16',
                                    '1710.03.17' => '1-1710.03.17',
                                    '1710.03.18' => '1-1710.03.18',
                                    '1710.03.19' => '1-1710.03.19',
                                    '1710.04' => '1-1710.04',
                                    '1710.05' => '1-1710.05',
                                    '2000' => '2-2000',
                                    '2000.01' => '2-2000.01',
                                    '2000.02' => '2-2000.02',
                                    '2000.03' => '2-2000.03',
                                    '2000.04' => '2-2000.04',
                                    '2000.05' => '2-2000.05',
                                    '210102' => '2-210102',
                                    '210202' => '2-210202',
                                    '2200' => '2-2200',
                                    '2300' => '2-2300',
                                    '2300.02' => '2-2300.01',
                                    '2300.03' => '2-2300.02',
                                    '2300.05' => '2-2300.03',
                                    '2300.07' => '2-2300.04',
                                    '2300.08' => '2-2300.05',
                                    '2300.09' => '2-2300.06',
                                    '2300.1' => '2-2300.07',
                                    '2300.11' => '2-2300.08',
                                    '2300.12' => '2-2300.09',
                                    '2300.13' => '2-2300.10',
                                    '2300.13.01' => '2-2300.10.01',
                                    '2300.14' => '2-2300.11',
                                    '2300.15' => '2-2300.12',
                                    '2300.15.01' => '2-2300.12.01',
                                    '2300.15.02' => '2-2300.12.02',
                                    '2300.15.03' => '2-2300.12.03',
                                    '2300.15.04' => '2-2300.12.04',
                                    '2300.15.05' => '2-2300.12.05',
                                    '2300.17' => '2-2300.13',
                                    '2300.18' => '2-2300.14',
                                    '2300.19' => '2-2300.15',
                                    '2300.2' => '2-2300.16',
                                    '2300.21' => '2-2300.17',
                                    '2300.22' => '2-2300.18',
                                    '2300.23' => '2-2300.19',
                                    '2300.24' => '2-2300.20',
                                    '3000' => '3-3000',
                                    '310001' => '3-310001',
                                    '320001' => '3-320001',
                                    '4000' => '4-4000',
                                    '4000.01' => '4-4000.01',
                                    '4000.01.01' => '4-4000.01.01',
                                    '4000.01.02' => '4-4000.01.02',
                                    '4000.01.03' => '4-4000.01.03',
                                    '4000.01.04' => '4-4000.01.04',
                                    '4000.01.05' => '4-4000.01.05',
                                    '4000.01.06' => '4-4000.01.06',
                                    '4000.01.07' => '4-4000.01.07',
                                    '4000.01.08' => '4-4000.01.08',
                                    '4000.01.09' => '4-4000.01.09',
                                    '4000.01.10' => '4-4000.01.10',
                                    '4000.01.11' => '4-4000.01.11',
                                    '4000.01.12' => '4-4000.01.12',
                                    '4000.01.13' => '4-4000.01.13',
                                    '4000.02' => '4-4000.02',
                                    '4000.02.01' => '4-4000.02.01',
                                    '4000.02.02' => '4-4000.02.02',
                                    '4000.02.03' => '4-4000.02.03',
                                    '4000.02.04' => '4-4000.02.04',
                                    '4000.02.05' => '4-4000.02.05',
                                    '4000.02.06' => '4-4000.02.06',
                                    '4000.02.07' => '4-4000.02.07',
                                    '4000.02.08' => '4-4000.02.08',
                                    '4000.02.09' => '4-4000.02.09',
                                    '4000.02.11' => '4-4000.02.10',
                                    '4000.02.12' => '4-4000.02.11',
                                    '4000.02.14' => '4-4000.02.12',
                                    '4000.02.15' => '4-4000.02.13',
                                    '4000.03' => '4-4000.03',
                                    '4000.03.01' => '4-4000.03.01',
                                    '4000.03.02' => '4-4000.03.02',
                                    '4000.03.03' => '4-4000.03.03',
                                    '4000.03.04' => '4-4000.03.04',
                                    '4000.03.05' => '4-4000.03.05',
                                    '4000.03.06' => '4-4000.03.06',
                                    '4000.03.07' => '4-4000.03.07',
                                    '4000.03.08' => '4-4000.03.08',
                                    '4000.03.09' => '4-4000.03.09',
                                    '4000.03.10' => '4-4000.03.10',
                                    '4000.04' => '4-4000.04',
                                    '4000.04.01' => '4-4000.04.01',
                                    '4000.04.01.01' => '4-4000.04.01.01',
                                    '4000.04.01.02' => '4-4000.04.01.02',
                                    '4000.04.01.03' => '4-4000.04.01.03',
                                    '4000.04.01.04' => '4-4000.04.01.04',
                                    '4000.04.01.05' => '4-4000.04.01.05',
                                    '4000.04.02' => '4-4000.04.02',
                                    '4000.04.03' => '4-4000.04.03',
                                    '4000.04.05' => '4-4000.04.04',
                                    '4000.04.06' => '4-4000.04.05',
                                    '4000.04.07' => '4-4000.04.06',
                                    '4000.04.08' => '4-4000.04.07',
                                    '4000.04.09' => '4-4000.04.08',
                                    '4000.04.10' => '4-4000.04.09',
                                    '4000.05' => '4-4000.05',
                                    '4000.06' => '4-4000.06',
                                    '4000.07' => '4-4000.07',
                                    '4000.08' => '4-4000.08',
                                    '4000.08.01' => '4-4000.08.01',
                                    '4000.08.02' => '4-4000.08.02',
                                    '4000.08.03' => '4-4000.08.03',
                                    '4000.09' => '4-4000.09',
                                    '4000.1' => '4-4000.10',
                                    '4000.11' => '4-4000.11',
                                    '4000.11.01' => '4-4000.11.01',
                                    '4000.11.02' => '4-4000.11.02',
                                    '4000.11.03' => '4-4000.11.03',
                                    '4000.11.04' => '4-4000.11.04',
                                    '4000.11.05' => '4-4000.11.05',
                                    '4000.12' => '4-4000.12',
                                    '4000.12.01' => '4-4000.12.01',
                                    '4000.12.02' => '4-4000.12.02',
                                    '4000.12.03' => '4-4000.12.03',
                                    '4000.12.04' => '4-4000.12.04',
                                    '4000.12.05' => '4-4000.12.05',
                                    '4000.12.06' => '4-4000.12.06',
                                    '4000.12.07' => '4-4000.12.07',
                                    '4000.12.08' => '4-4000.12.08',
                                    '4000.12.09' => '4-4000.12.09',
                                    '4000.13' => '4-4000.13',
                                    '4000.14' => '4-4000.14',
                                    '4000.15' => '4-4000.15',
                                    '4000.15.01' => '4-4000.15.01',
                                    '4000.15.02' => '4-4000.15.02',
                                    '5000' => '5-5000',
                                    '6000' => '6-6000',
                                    '6000.01' => '6-6000.01',
                                    '6000.02' => '6-6000.02',
                                    '6000.03' => '6-6000.03',
                                    '6000.04' => '6-6000.04',
                                    '6001' => '6-6001',
                                    '6001.01' => '6-6001.01',
                                    '6001.02' => '6-6001.02',
                                    '6001.03' => '6-6001.03',
                                    '6002' => '6-6002',
                                    '6002.01' => '6-6002.01',
                                    '6100' => '6-6100',
                                    '6100.01' => '6-6100.01',
                                    '6100.02' => '6-6100.02',
                                    '6100.03' => '6-6100.03',
                                    '6200' => '6-6200',
                                    '6201' => '6-6201',
                                    '6201.01' => '6-6201.01',
                                    '6201.01.1' => '6-6201.01.01',
                                    '6201.02' => '6-6201.02',
                                    '6201.02.01' => '6-6201.02.01',
                                    '6201.02.02' => '6-6201.02.02',
                                    '6201.02.03' => '6-6201.02.03',
                                    '6201.02.04' => '6-6201.02.04',
                                    '6201.02.06' => '6-6201.02.05',
                                    '6201.02.07' => '6-6201.02.06',
                                    '6202' => '6-6202',
                                    '6202.01' => '6-6202.01',
                                    '6202.02' => '6-6202.02',
                                    '6202.03' => '6-6202.03',
                                    '6202.04' => '6-6202.04',
                                    '6202.05' => '6-6202.05',
                                    '6203' => '6-6203',
                                    '6203.01' => '6-6203.01',
                                    '6203.02' => '6-6203.02',
                                    '6203.03' => '6-6203.03',
                                    '6203.04' => '6-6203.04',
                                    '6203.04.01' => '6-6203.04.01',
                                    '6203.04.02' => '6-6203.04.02',
                                    '6203.04.03' => '6-6203.04.03',
                                    '6203.04.04' => '6-6203.04.04',
                                    '6203.04.05' => '6-6203.04.05',
                                    '6203.04.06' => '6-6203.04.06',
                                    '6203.04.07' => '6-6203.04.07',
                                    '6203.04.08' => '6-6203.04.08',
                                    '6203.05' => '6-6203.05',
                                    '6204' => '6-6204',
                                    '6204.01' => '6-6204.01',
                                    '6204.02' => '6-6204.02',
                                    '6204.03' => '6-6204.03',
                                    '6204.04' => '6-6204.04',
                                    '6204.05' => '6-6204.05',
                                    '6204.06' => '6-6204.06',
                                    '6204.07' => '6-6204.07',
                                    '6204.08' => '6-6204.08',
                                    '6204.09' => '6-6204.09',
                                    '6204.1' => '6-6204.10',
                                    '6204.11' => '6-6204.11',
                                    '6204.12' => '6-6204.12',
                                    '6204.13' => '6-6204.13',
                                    '6204.14' => '6-6204.14',
                                    '6204.15' => '6-6204.15',
                                    '6205' => '6-6205',
                                    '6205.01' => '6-6205.01',
                                    '6205.02' => '6-6205.02',
                                    '6205.03' => '6-6205.03',
                                    '6205.04' => '6-6205.04',
                                    '6206' => '6-6206',
                                    '6206.01' => '6-6206.01',
                                    '6206.02' => '6-6206.02',
                                    '6206.03' => '6-6206.03',
                                    '6206.04' => '6-6206.04',
                                    '6206.05' => '6-6206.05',
                                    '6206.07' => '6-6206.06',
                                    '6207' => '6-6207',
                                    '6207.01' => '6-6207.01',
                                    '6207.02' => '6-6207.02',
                                    '6207.02.01' => '6-6207.02.01',
                                    '6207.02.02' => '6-6207.02.02',
                                    '6207.02.03' => '6-6207.02.03',
                                    '6207.02.04' => '6-6207.02.04',
                                    '6207.02.05' => '6-6207.02.05',
                                    '6208' => '6-6208',
                                    '6208.01' => '6-6208.01',
                                    '6208.02' => '6-6208.02',
                                    '6208.03' => '6-6208.03',
                                    '6208.03.01' => '6-6208.03.01',
                                    '6208.03.02' => '6-6208.03.02',
                                    '6208.03.05' => '6-6208.03.03',
                                    '6208.03.06' => '6-6208.03.04',
                                    '6208.03.07' => '6-6208.03.05',
                                    '6208.03.08' => '6-6208.03.06',
                                    '6208.03.09' => '6-6208.03.07',
                                    '6208.03.10' => '6-6208.03.08',
                                    '6208.03.11' => '6-6208.03.09',
                                    '6208.03.12' => '6-6208.03.10',
                                    '6208.03.13' => '6-6208.03.11',
                                    '6208.03.14' => '6-6208.03.12',
                                    '6208.03.15' => '6-6208.03.13',
                                    '6208.03.16' => '6-6208.03.14',
                                    '6208.03.17' => '6-6208.03.15',
                                    '6208.03.18' => '6-6208.03.16',
                                    '6208.03.19' => '6-6208.03.17',
                                    '6208.03.20' => '6-6208.03.18',
                                    '6208.03.21' => '6-6208.03.19',
                                    '6208.03.22' => '6-6208.03.20',
                                    '6208.03.24' => '6-6208.03.21',
                                    '6208.03.25' => '6-6208.03.22',
                                    '6208.03.26' => '6-6208.03.23',
                                    '6208.03.27' => '6-6208.03.24',
                                    '6208.03.28' => '6-6208.03.25',
                                    '6208.03.29' => '6-6208.03.26',
                                    '6208.03.30' => '6-6208.03.27',
                                    '6208.03.31' => '6-6208.03.28',
                                    '6208.03.32' => '6-6208.03.29',
                                    '6208.04' => '6-6208.04',
                                    '6208.05' => '6-6208.05',
                                    '6208.06' => '6-6208.06',
                                    '6208.07' => '6-6208.07',
                                    '6208.07.01' => '6-6208.07.01',
                                    '6208.07.02' => '6-6208.07.02',
                                    '6208.07.03' => '6-6208.07.03',
                                    '6208.07.04' => '6-6208.07.04',
                                    '6208.07.05' => '6-6208.07.05',
                                    '6208.07.06' => '6-6208.07.06',
                                    '6208.07.07' => '6-6208.07.07',
                                    '6208.08' => '6-6208.08',
                                    '6209' => '6-6209',
                                    '6210' => '6-6210',
                                    '6210.01' => '6-6210.01',
                                    '6210.02' => '6-6210.02',
                                    '6210.03' => '6-6210.03',
                                    '6211' => '6-6211',
                                    '6211.01' => '6-6211.01',
                                    '6211.02' => '6-6211.02',
                                    '6211.03' => '6-6211.03',
                                    '6211.04' => '6-6211.04',
                                    '6211.05' => '6-6211.05',
                                    '6211.06' => '6-6211.06',
                                    '6211.07' => '6-6211.07',
                                    '6213' => '6-6212',
                                    '6213.01' => '6-6212.01',
                                    '6213.01.01' => '6-6212.01.01',
                                    '6213.01.02' => '6-6212.01.02',
                                    '6213.01.03' => '6-6212.01.03',
                                    '6213.01.04' => '6-6212.01.04',
                                    '6213.01.05' => '6-6212.01.05',
                                    '6213.01.06' => '6-6212.01.06',
                                    '6213.01.07' => '6-6212.01.07',
                                    '6213.01.08' => '6-6212.01.08',
                                    '6213.01.09' => '6-6212.01.09',
                                    '6213.01.10' => '6-6212.01.10',
                                    '6213.02' => '6-6212.02',
                                    '6213.02.01' => '6-6212.02.01',
                                    '6213.02.02' => '6-6212.02.02',
                                    '6213.02.03' => '6-6212.02.03',
                                    '6213.02.04' => '6-6212.02.04',
                                    '6213.02.05' => '6-6212.02.05',
                                    '6213.02.06' => '6-6212.02.06',
                                    '6213.02.07' => '6-6212.02.07',
                                    '6213.02.08' => '6-6212.02.08',
                                    '6213.02.09' => '6-6212.02.09',
                                    '6213.02.10' => '6-6212.02.10',
                                    '6213.02.11' => '6-6212.02.11',
                                    '6213.02.12' => '6-6212.02.12',
                                    '6213.02.13' => '6-6212.02.13',
                                    '6213.02.14' => '6-6212.02.14',
                                    '6213.02.14.01' => '6-6212.02.14.01', 
                                    '6213.02.14.02' => '6-6212.02.14.02',
                                    '6213.02.14.03' => '6-6212.02.14.03',
                                    '6213.02.14.04' => '6-6212.02.14.04',
                                    '6213.02.14.05' => '6-6212.02.14.05',
                                    '6213.02.14.06' => '6-6212.02.14.06',
                                    '6213.02.14.07' => '6-6212.02.14.07',
                                    '6213.02.14.08' => '6-6212.02.14.08',
                                    '6213.02.14.09' => '6-6212.02.14.09',
                                    '6213.02.15' => '6-6212.02.15',
                                    '6213.03' => '6-6212.03',
                                    '6213.03.01' => '6-6212.03.01',
                                    '6213.03.02' => '6-6212.03.02',
                                    '6213.03.03' => '6-6212.03.03',
                                    '6213.04' => '6-6212.04',
                                    '6213.04.01' => '6-6212.04.01',
                                    '6213.04.02' => '6-6212.04.02',
                                    '6213.04.03' => '6-6212.04.03',
                                    '6213.04.04' => '6-6212.04.04',
                                    '6213.04.05' => '6-6212.04.05',
                                    '6213.04.06' => '6-6212.04.06',
                                    '6213.04.07' => '6-6212.04.07',
                                    '6213.04.08' => '6-6212.04.08',
                                    '6213.04.09' => '6-6212.04.09',
                                    '6213.04.10' => '6-6212.04.10',
                                    '6213.04.11' => '6-6212.04.11',
                                    '6213.04.12' => '6-6212.04.12',
                                    '6213.04.13' => '6-6212.04.13',
                                    '6213.04.14' => '6-6212.04.14',
                                    '6213.04.15' => '6-6212.04.15',
                                    '6213.04.16' => '6-6212.04.16',
                                    '6213.05' => '6-6212.05',
                                    '6213.05.01' => '6-6212.05.01',
                                    '6213.05.02' => '6-6212.05.02',
                                    '6214' => '6-6213',
                                    '6214.01' => '6-6213.01',
                                    '6214.01.01' => '6-6213.01.01',
                                    '6214.01.02' => '6-6213.01.02',
                                    '6214.01.03' => '6-6213.01.03',
                                    '6214.01.04' => '6-6213.01.04',
                                    '6214.01.05' => '6-6213.01.05',
                                    '6214.01.06' => '6-6213.01.06',
                                    '6214.01.07' => '6-6213.01.07',
                                    '6214.01.08' => '6-6213.01.08',
                                    '6214.01.09' => '6-6213.01.09',
                                    '6214.02' => '6-6213.02',
                                    '6214.02.01' => '6-6213.02.01',
                                    '6214.02.02' => '6-6213.02.02',
                                    '6214.02.03' => '6-6213.02.03',
                                    '6214.02.04' => '6-6213.02.04',
                                    '6214.03' => '6-6213.03',
                                    '6214.03.01' => '6-6213.03.01',
                                    '6214.03.02' => '6-6213.03.02',
                                    '6214.04' => '6-6213.04',
                                    '6214.04.01' => '6-6213.04.01',
                                    '6213.04.01.01' => '6-6213.04.01.01',
                                    '6213.04.01.02' => '6-6213.04.01.02',
                                    '6213.04.01.03' => '6-6213.04.01.03',
                                    '6213.04.01.04' => '6-6213.04.01.04',
                                    '6213.04.01.05' => '6-6213.04.01.05',
                                    '6213.04.01.06' => '6-6213.04.01.06',
                                    '6213.04.01.07' => '6-6213.04.01.07',
                                    '6213.04.01.08' => '6-6213.04.01.08',
                                    '6213.04.01.09' => '6-6213.04.01.09',
                                    '6213.04.01.10' => '6-6213.04.01.10',
                                    '6213.04.01.11' => '6-6213.04.01.11',
                                    '6213.04.01.12' => '6-6213.04.01.12',
                                    '6213.04.01.13' => '6-6213.04.01.13',
                                    '6213.04.01.14' => '6-6213.04.01.14',
                                    '6213.04.01.15' => '6-6213.04.01.15',
                                    '6213.04.01.16' => '6-6213.04.01.16',
                                    '6213.04.01.17' => '6-6213.04.01.17',
                                    '6213.04.01.18' => '6-6213.04.01.18',
                                    '6214.04.02' => '6-6213.04.02',
                                    '6213.04.02.01' => '6-6213.04.02.01',
                                    '6213.04.02.02' => '6-6213.04.02.02',
                                    '6213.04.02.03' => '6-6213.04.02.03',
                                    '6213.04.02.04' => '6-6213.04.02.04',
                                    '6213.04.02.05' => '6-6213.04.02.05',
                                    '6213.04.02.06' => '6-6213.04.02.06',
                                    '6213.04.02.07' => '6-6213.04.02.07',
                                    '6213.04.02.08' => '6-6213.04.02.08',
                                    '6213.04.02.09' => '6-6213.04.02.09',
                                    '6213.04.02.10' => '6-6213.04.02.10',
                                    '6213.04.02.11' => '6-6213.04.02.11',
                                    '6213.04.02.12' => '6-6213.04.02.12',
                                    '6213.04.02.13' => '6-6213.04.02.13',
                                    '6214.04.03' => '6-6213.04.03',
                                    '6214.04.04' => '6-6213.04.04',
                                    '6214.05' => '6-6213.05',
                                    '6214.05.01' => '6-6213.05.01',
                                    '6214.05.02' => '6-6213.05.02',
                                    '6214.05.03' => '6-6213.05.03',
                                    '6214.05.04' => '6-6213.05.04',
                                    '6214.05.05' => '6-6213.05.05',
                                    '6214.05.06' => '6-6213.05.02', //pindah ke 6-6213.05.02
                                    '6214.05.07' => '6-6213.05.06',
                                    '6214.05.08' => '6-6213.05.07',
                                    '6214.06' => '6-6213.06',
                                    '6214.06.01' => '6-6213.06.01',
                                    '6214.06.02' => '6-6213.06.02',
                                    '6214.06.03' => '6-6213.06.03',
                                    '6214.06.04' => '6-6213.06.04',
                                    '6215' => '6-6214',
                                    '6215.01' => '6-6214.01',
                                    '6215.01.01' => '6-6214.01.01', //pindah ke 6-6214.01.01
                                    '6215.01.02' => '6-6214.01.01', //pindah ke 6-6214.01.01
                                    '6215.01.03' => '6-6214.01.01', //pindah ke 6-6214.01.01  
                                    '6215.01.04' => '6-6214.01.01',
                                    '6215.02' => '6-6214.02',
                                    '6216' => '6-6215',
                                    '6216.01' => '6-6215.01',
                                    '6216.01.01' => '6-6215.01.01', //pindah ke 6-6215.01.01
                                    '6216.01.02' => '6-6215.01.01', //pindah ke 6-6215.01.01
                                    '6216.01.03' => '6-6215.01.01', //pindah ke 6-6215.01.01
                                    '6216.01.04' => '6-6215.01.01',
                                    '6216.02' => '6-6215.02',
                                    '6216.02.01' => '6-6215.02.01',
                                    '6216.02.02' => '6-6215.02.02',
                                    '6216.02.03' => '6-6215.02.03',
                                    '6217' => '6-6216',
                                    '6217.01' => '6-6216.01', //pindah ke 6-6216.01
                                    '6217.02' => '6-6216.01', //pindah ke 6-6216.01
                                    '6217.03' => '6-6216.01', //pindah ke 6-6216.01
                                    '6217.04' => '6-6216.01',
                                    '6217.05' => '6-6216.01', //pindah ke 6-6216.01
                                    '6217.06' => '6-6216.01', //pindah ke 6-6216.01
                                    '6217.07' => '6-6216.01', //pindah ke 6-6216.01
                                    '6218' => '6-6217',
                                    '6218.01' => '6-6217.01',
                                    '6218.02' => '6-6217.02',
                                    '6218.03' => '6-6217.03',
                                    '6218.04' => '6-6217.04',
                                    '6218.05' => '6-6217.05',
                                    '6219' => '6-6218',
                                    '6219.01' => '6-6218.01',
                                    '6219.02' => '6-6218.02',
                                    '6219.03' => '6-6218.03',
                                    '6219.04' => '6-6218.04',
                                    '6219.05' => '6-6218.05',
                                    '6219.05.01' => '6-6218.05.01',
                                    '6219.05.02' => '6-6218.05.02',
                                    '6219.05.03' => '6-6218.05.03',
                                    '6219.05.04' => '6-6218.05.04',
                                    '6219.05.05' => '6-6218.05.05',
                                    '6219.05.06' => '6-6218.05.06',
                                    '6219.05.07' => '6-6218.05.07',
                                    '6219.05.08' => '6-6218.05.08',
                                    '6219.05.09' => '6-6218.05.09',
                                    '6219.05.11' => '6-6218.05.10',
                                    '6219.05.12' => '6-6218.05.11',
                                    '6219.05.13' => '6-6218.05.12',
                                    '6219.05.14' => '6-6218.05.13',
                                    '6219.06' => '6-6218.06',
                                    '6219.06.01' => '6-6218.06.01',
                                    '6219.06.02' => '6-6218.06.02',
                                    '6219.06.03' => '6-6218.06.03',
                                    '6219.06.04' => '6-6218.06.04',
                                    '6219.07' => '6-6218.07',
                                    '6219.08' => '6-6218.08',
                                    '6219.08.01' => '6-6218.08.01',
                                    '6219.08.02' => '6-6218.08.02',
                                    '6219.08.03' => '6-6218.08.03',
                                    '6219.09' => '6-6218.09',
                                    '6219.1' => '6-6218.10',
                                    '6219.11' => '6-6218.11',
                                    '6219.12' => '6-6218.12',
                                    '6219.12.01' => '6-6218.12.01',
                                    '6219.12.02' => '6-6218.12.02',
                                    '6219.12.03' => '6-6218.12.03',
                                    '6219.13' => '6-6218.13',
                                    '6219.13.01' => '6-6218.13.01',
                                    '6219.13.01.01' => '6-6218.13.01.01',
                                    '6219.13.01.02' => '6-6218.13.01.02',
                                    '6219.13.01.03' => '6-6218.13.01.03',
                                    '6219.13.01.04' => '6-6218.13.01.04',
                                    '6219.13.02' => '6-6218.13.02',
                                    '6219.13.03' => '6-6218.13.03',
                                    '6219.13.03.01' => '6-6218.13.03.01',
                                    '6219.13.03.02' => '6-6218.13.03.02',
                                    '6219.13.03.03' => '6-6218.13.03.03',
                                    '6219.13.04' => '6-6218.13.04',
                                    '6219.13.04.01' => '6-6218.13.04.01',
                                    '6219.13.04.02' => '6-6218.13.04.02',
                                    '6219.13.04.03' => '6-6218.13.04.03',
                                    '6219.16' => '6-6218.13.05',
                                    '6219.16.01' => '6-6218.13.01',
                                    '6219.16.02' => '6-6218.13.02',
                                    '6219.16.03' => '6-6218.13.03',
                                    '6219.14' => '6-6218.14',
                                    '6219.14.01' => '6-6218.14.01',
                                    '6219.14.02' => '6-6218.14.02',
                                    '6219.14.03' => '6-6218.14.03',
                                    '6219.15' => '6-6218.15',
                                    '6220' => '6-6219',
                                    '6220.01' => '6-6219.01',
                                    '6220.02' => '6-6219.02',
                                    '6220.03' => '6-6219.03',
                                    '6220.05' => '6-6219.04',
                                    '6220.05.01' => '6-6219.04.01',
                                    '6220.05.02' => '6-6219.04.02',
                                    '6220.06' => '6-6219.05',
                                    '6221' => '6-6220',
                                    '6221.01' => '6-6220.01',
                                    '6221.02' => '6-6220.02',
                                    '6221.03' => '6-6220.03',
                                    '6221.04' => '6-6220.04',
                                    '6221.04.01' => '6-6220.04.01',
                                    '6221.04.03' => '6-6220.04.02',
                                    '6221.04.04' => '6-6220.04.03',
                                    '6221.04.05' => '6-6220.04.04',
                                    '6221.04.06' => '6-6220.04.05',
                                    '6221.05' => '6-6220.05',
                                    '6221.06' => '6-6220.06',
                                    '6222' => '6-6221',
                                    '6222.01' => '6-6221.01',
                                    '6222.02' => '6-6221.02',
                                    '6223' => '6-6222',
                                    '6223.01' => '6-6222.01',
                                    '6224' => '6-6223',
                                    '6224.01' => '6-6223.01',
                                    '6224.02' => '6-6223.02',
                                    '6224.03' => '6-6223.03',
                                    '6224.04' => '6-6223.04',
                                    '6224.05' => '6-6223.05',
                                    '6224.06' => '6-6223.06',
                                    '6224.07' => '6-6223.07',
                                    '6224.08' => '6-6223.08',
                                    '6224.08.01' => '6-6223.08.01',
                                    '6224.08.02' => '6-6223.08.02',
                                    '6225' => '6-6224',
                                    '6225.01' => '6-6224.01',
                                    '6225.02' => '6-6224.02',
                                    '6225.03' => '6-6224.03',
                                    '6225.04' => '6-6224.04',
                                    '6225.05' => '6-6224.05',
                                    '6225.06' => '6-6224.06',
                                    '6225.06.1' => '6-6224.06.01',
                                    '6225.07' => '6-6224.07',
                                    '6225.08' => '6-6224.08',
                                    '6225.1' => '6-6224.09',
                                    '6225.11' => '6-6224.10',
                                    '6226' => '6-6225',
                                    '6226.01' => '6-6225.01',
                                    '6226.02' => '7-7200.02', //pindah ke 7-7200.02
                                    '6226.03' => '6-6225.02',
                                    '6226.04' => '6-6225.03',
                                    '6226.05' => '6-6225.04',
                                    '6227' => '6-6226',
                                    '6227.01' => '6-6226.01',
                                    '6227.02' => '6-6226.02',
                                    '6228' => '6-6227',
                                    '6228.01' => '6-6227.01',
                                    '6228.02' => '6-6227.02',
                                    '6229' => '6-6228',
                                    '6230' => '6-6229',
                                    '6230.01' => '6-6229.01',
                                    '6300' => '6-6230',
                                    '6300.01' => '6-6230.01',
                                    '6300.02' => '6-6230.02',
                                    '6300.03' => '6-6230.03',
                                    '6300.04' => '6-6230.04',
                                    '6300.05' => '6-6230.05',
                                    '6300.06' => '6-6230.06',
                                    '6400' => '6-6231',
                                    '7100' => '7-7100',
                                    '7100.01' => '7-7100.01',
                                    '7100.02' => '7-7100.02',
                                    '7100.03' => '7-7100.03',
                                    '7100.04' => '7-7100.04',
                                    '7100.05' => '7-7100.05',
                                    '4000.16.01' => '4-4000.16.01',
                                    '7200' => '7-7200',
                                    '7200.01' => '7-7200.01',
                                    '7200.02' => '7-7200.02',
                                    '7200.03' => '7-7200.03',
                                    '7200.04' => '7-7200.04',
                                    '7200.05' => '7-7200.05',
                                    '8100' => '8-8100',
                                    '8200' => '8-8200',
                                    '910002' => '9-910002',
                                    '910003' => '9-910003',
                                ];

                                if (isset($accountMapping[$accountNoOri])) {
                                    $accountMap = $accountMapping[$accountNoOri];
                                }

                                $detailCompare->number = $journal['JVNUMBER'];
                                $detailCompare->transDate = date('Y-m-d', strtotime($journal['TRANSDATE'])); // Pastikan format tanggal sesuai dengan kolom di database
                                $detailCompare->accountNo = $accountMap;
                                $detailCompare->accountOri = $detail['GLACCOUNT'];
                                $detailCompare->amount = (double)(str_replace('-', '', $detail['GLAMOUNT']));
                                $detailCompare->amountType = isset($detail['SEQ']) && $detail['SEQ'] == 1 ? 'CREDIT' : 'DEBIT';
                                $detailCompare->memo = $detail['DESCRIPTION'];
                                $detailCompare->vendorNo = $detail['SUBSIDIARY'] ?? "";
                                $detailCompare->save();
                            }                   
                        }

                        // echo "<pre>";
                        // print_r($filteredData);
                        // echo "</pre>";
                        // exit;

                        Yii::$app->session->set('importJournalFromJson', $filteredData);
                        Yii::$app->session->setFlash('success', "Files successfully uploaded and processed.");

                        return $this->redirect(['journal-index']);
                        // Render view untuk menampilkan tabel atau cek hasil
                        // return $this->render('jsonuploadjournaltable', [
                        //     'filteredData' => $filteredData,
                        // ]);
                    } else {
                        Yii::$app->session->setFlash('error', 'Invalid JSON format. Expected keys "JV" and "JVDET".');
                    }
                } else {
                    Yii::$app->session->setFlash('error', 'Failed to save uploaded files.');
                }

                return $this->refresh();
            }
        }

        return $this->render('jsonuploadjurnalindex', [
            'model' => $model,
        ]);
    }

    //kalo send satu, perlu set id di parameter
    public function actionSendapi() 
    {
        // $selectedIds = Yii::$app->request->post('selection', []); 
        // $accounts = Accounts::findAll($selectedIds);
        $accounts = Yii::$app->session->get('importAccountFromJson', []);

        Yii::$app->session->set('accountData', $accounts);
        Yii::$app->session->set('inputScope', 'glaccount_save');

        return $this->redirect(['accurate/authorize']);
    }
    public function actionSendjournalapi() 
    {
        $selectedIds = Yii::$app->request->post('selection', []);
        $journals = JournalCompare::find()->andWhere(['in', 'id', $selectedIds])->asArray()->all();
        
        // foreach ($journals as $journalprint) {
        //     echo "<pre>";
        //     var_dump($journalprint); 
        //     echo "</pre>";
        // }
        // exit; 

        //ini kalo cara lama
        // $journals = Yii::$app->session->get('importJournalFromJson', []);

        // Siapkan struktur data untuk API
        $formattedData = [];
        foreach ($journals as $journal) {
            $number = $journal['number'];
            $journalData = [
                'number' => $journal['number'],
                'transDate' => $journal['transDate'],
                'description' => $journal['description'],
                'branchName' => $journal['branchName'],
                'detailJournalVoucher' => [],
            ];
            
            $details = DetailCompare::find()->where(['number' => $number])->all();
            // Tambahkan detail jurnal
            foreach ($details as $detail) {
                $journalData['detailJournalVoucher'][] = [
                    'accountNo' => $detail->accountNo, 
                    'amount' => $detail->amount,
                    'amountType' => $detail->amountType,
                    'memo' => $detail->memo, 
                    'vendorNo' => $detail->vendorNo, 
                ];
            }

            $formattedData[] = $journalData;
        }

        // echo "<pre>";
        // var_dump($formattedData); 
        // echo "</pre>";
        // exit;
        
        Yii::$app->session->set('journalData', $formattedData);
        Yii::$app->session->set('inputScope', "journal_voucher_save");
        
        return $this->redirect(['accurate/authorize']);
    }

    public function actionDeletealljournalapi() 
    {
        // var_dump('masuk');die;
        $ids = range(1, 99);
        Yii::$app->session->set('deleteJournalData', $ids);
        Yii::$app->session->set('inputScope', 'journal_voucher_delete');

        return $this->redirect(['accurate/authorize']);
    }
    
    public function actionSendaccountstoaol() //ini ke database XD
    {
        // Ambil data dari session yang disimpan sebelumnya
        $importedAccounts = Yii::$app->session->get('importAccountFromJson', []);
        // var_dump($importedAccounts); die;
        
        if (empty($importedAccounts)) {
            Yii::$app->session->setFlash('error', 'Tidak ada data yang tersedia untuk diimpor.');
            return $this->redirect(['jsonuploadindex']);
        }
        
        try {
            foreach ($importedAccounts as $accountData) {
                $account = new Accounts();
                
                $data = [
                    'accountType' => $accountData['accountType'],
                    'asOf' => $accountData['asOf'],
                    'currencyCode' => $accountData['currencyCode'],
                    'name' => $accountData['name'],
                    'no' => $accountData['no'],
                    'parentNo' => $accountData['parentNo'],
                    'memo' => $accountData['memo'],
                ];

                $account->attributes = $data;
                $account->save();
            }
            
            // Menampilkan pesan sukses
            Yii::$app->session->setFlash('success', 'Akun berhasil masuk ke database!');
        } catch (\Exception $e) {
            // Jika terjadi error, batalkan transaksi dan tampilkan pesan error
            Yii::$app->session->setFlash('error', 'Terjadi kesalahan: ' . $e->getMessage());
        }

        return $this->redirect(['api/index']);
    }
    
    public function actionSendjournalstoaol() //ini ke database XD
    {
        $importedJournals = Yii::$app->session->get('importJournalFromJson', []);
        
        if (empty($importedJournals)) {
            Yii::$app->session->setFlash('error', 'Tidak ada data yang tersedia untuk diimpor.');
            return $this->redirect(['jsonuploadindex']);
        }
        
        try {
            foreach ($importedJournals as $journalData) {
                // Buat model baru untuk setiap account
                $journal = new Journal();
                
                $data = [
                    'number' => $journalData['number'],
                    'transDate' => $journalData['transDate'],
                    'description' => $journalData['description'],
                    'accountNo' => $journalData['accountNo'],
                    'amount' => $journalData['amount'],
                    'amountType' => $journalData['amountType'],
                    'memo' => $journalData['memo'],
                ];

                $journal->attributes = $data;
                $journal->save();
            }
            
            // Menampilkan pesan sukses
            Yii::$app->session->setFlash('success', 'Jurnal berhasil masuk ke database!');
        } catch (\Exception $e) {
            // Jika terjadi error, batalkan transaksi dan tampilkan pesan error
            Yii::$app->session->setFlash('error', 'Terjadi kesalahan: ' . $e->getMessage());
        }

        // Redirect ke halaman lain setelah proses selesai
        return $this->redirect(['api/journal-index']);
    }
    public function actionFilldatabasewithjournal(){
        for ($jurnal=1; $jurnal<=51000; $jurnal++){
            //simpan dulu journal numbernya
            $journalNumber = sprintf("TEST%05d", $jurnal);
            //randomize tanggal
            $startDate = strtotime('2016-01-01');
            $endDate = time(); // Waktu sekarang
            $randomTimestamp = mt_rand($startDate, $endDate);

            $journalCompare = new JournalCompare();
            $journalCompare->number = $journalNumber; 
            $journalCompare->trans_date = date('d/m/Y', $randomTimestamp);
            $branchNames = ["Yayasan SAAT", "STT SAAT"];
            $journalCompare->branchName = $branchNames[array_rand($branchNames)];
            $journalCompare->save();

            $accountRandom = [            
                '1000',
                '1001',
                '1001.01',
                '1001.02',
                '1001.03', //pindah
                '1001.04',
                '1001.05', //pindah
                '1001.06',
                '1001.07', //pindah
                '1001.08',
            ];
            $accountNoOri = $accountRandom[array_rand($accountRandom)];
                    
            //pemetaan belum dipake
            $accountMapping = [            
                '1000' => '1-1000',
                '1001' => '1-1001',
                '1001.01' => '1-1001.01',
                '1001.02' => '1-1001.02',
                '1001.03' => '1-1001.02', //pindah
                '1001.04' => '1-1001.03',
                '1001.05' => '1-1001.02', //pindah
                '1001.06' => '1-1001.04',
                '1001.07' => '1-1001.02', //pindah
                '1001.08' => '1-1001.05',
            ];
            if (isset($accountMapping[$accountNoOri])) {
                $accountMap = $accountMapping[$accountNoOri];
            }
            
            $jumlah_kredit = 0;
            for($detail=1; $detail<50; $detail++) {
                //masukkan debit dulu
                $jumlah_debit = mt_rand(1000, 5000);
                $jumlah_kredit += $jumlah_debit;

                $detailCompare = new DetailCompare();
                $detailCompare->number = $journalNumber;
                $detailCompare->trans_date = date('Y-m-d', $randomTimestamp); 
                $detailCompare->account_ori = $accountNoOri;
                $detailCompare->amount = $jumlah_debit;
                $detailCompare->amount_type = 'DEBIT';
                $detailCompare->save();
            }

            //masukkan kreditnya
            $detailCompare = new DetailCompare();
            $detailCompare->number = $journalNumber;
            $detailCompare->trans_date = date('Y-m-d', $randomTimestamp); 
            $detailCompare->account_ori = $accountNoOri;
            $detailCompare->amount = $jumlah_kredit;
            $detailCompare->amount_type = 'CREDIT';
            $detailCompare->save();
        }
    }
}

